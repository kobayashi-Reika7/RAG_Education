# 要件定義書

## RAG教育クイズアプリ

| 項目       | 内容                         |
| ---------- | ---------------------------- |
| 作成日     | 2026/02/16                   |
| バージョン | 2.0                          |
| ステータス | 実装完了                     |

---

## 1. 目的・ゴール

### 目的

新人教育で使用するマニュアル（PDF等）の内容をRAGとして取り込み、
**自然言語で質問応答**・**理解度テスト（クイズ5問セット）**・**問題演習（4択ドリル）**を行える学習支援アプリを開発する。

### ゴール

- 新人が教育マニュアルの内容を**対話形式で学習**できる
- 理解度を**5問1セットのクイズ**で自己チェックし、**正答率**を確認できる
- **4択演習**で気軽に知識を定着できる
- 回答にはマニュアルの**根拠（出典）**が表示される
- **Firebase認証**で個人の学習履歴を記録できる

---

## 2. 対象ユーザー

| ユーザー | 説明                                       |
| -------- | ------------------------------------------ |
| 新人社員 | 教育マニュアルの内容を学習する             |
| 教育担当 | マニュアルPDFをアップロード・管理する（v2）|

※ v1（MVP）では新人社員のみを対象とする

---

## 3. 機能一覧

### 3.1 RAG質問応答機能（必須）

| # | 機能             | 説明                                                   |
| - | ---------------- | ------------------------------------------------------ |
| 1 | 自然言語質問     | テキスト入力欄から自由文で質問できる                   |
| 2 | RAG検索・回答    | マニュアルから関連箇所を検索し、LLMが回答を生成する   |
| 3 | 出典表示         | 回答の根拠となったマニュアルの該当箇所を表示する       |

### 3.2 理解度テスト（クイズ）機能（必須）

| # | 機能             | 説明                                                   |
| - | ---------------- | ------------------------------------------------------ |
| 1 | 難易度選択       | 初級 / 中級 / 上級 の3段階から選択できる               |
| 2 | 5問1セット出題   | 5問連続で出題し、進捗バーで現在の問題番号を表示する   |
| 3 | ランダム出題形式 | 一問一答・穴埋め・○×判定・比較説明・理由説明・具体例からランダムに出題 |
| 4 | 自然言語回答     | クイズに対して自由文で回答できる                       |
| 5 | ○×判定・採点     | LLMが回答の正誤を判定し、スコア（0.0〜1.0）を表示する |
| 6 | 解説表示         | 不正解時にマニュアルに基づく解説を返す                 |
| 7 | 正答率表示       | 5問終了後に正答率・正解数・平均スコアを表示する       |

### 3.3 問題演習（4択ドリル）機能（必須）

| # | 機能             | 説明                                                   |
| - | ---------------- | ------------------------------------------------------ |
| 1 | 4択問題生成      | マニュアル内容を元にLLMが4択問題を生成する             |
| 2 | 選択式回答       | A/B/C/D の選択肢から1つ選んで回答する                  |
| 3 | 即時判定         | 回答後すぐに正誤と解説を表示する                       |

### 3.4 ユーザー認証機能（必須）

| # | 機能             | 説明                                                   |
| - | ---------------- | ------------------------------------------------------ |
| 1 | メール/パスワード | Firebase Auth でメール・パスワードログインできる       |
| 2 | Google ログイン   | Google アカウントでもログインできる                    |
| 3 | ログアウト       | サイドバーからログアウトできる                         |

### 3.5 学習履歴・統計機能（必須）

| # | 機能             | 説明                                                   |
| - | ---------------- | ------------------------------------------------------ |
| 1 | 結果の自動保存   | クイズ・演習の結果をFirestoreに自動保存する             |
| 2 | 統計ダッシュボード | 総クイズ数・総演習数・平均スコア・連続学習日数を表示 |
| 3 | 直近の履歴       | 直近の学習履歴を一覧表示する                           |

### 3.6 難易度の定義

| 難易度 | 出題傾向                                           | 回答判定基準                     |
| ------ | -------------------------------------------------- | -------------------------------- |
| 初級   | マニュアルに直接書かれている事実の確認              | キーワードが含まれていれば正解   |
| 中級   | 複数箇所の情報を組み合わせて答える問題              | 要点を押さえていれば正解         |
| 上級   | 応用・考察を求める問題（「なぜ？」「どう思う？」） | 論理的に妥当であれば正解         |

---

## 4. 非機能要件

### 4.1 技術スタック

| レイヤー       | ローカル開発                   | AWS本番（Free Tier）             |
| -------------- | ------------------------------ | -------------------------------- |
| フロントエンド | Vite + React + TypeScript      | S3 Static Website Hosting        |
| バックエンド   | Python (FastAPI)               | Lambda + API Gateway (HTTP)      |
| LLM            | Gemini API (gemini-2.5-flash)  | Gemini API (同じ)                |
| ベクトル検索   | ChromaDB（ローカルファイル）   | SimpleVectorStore (embeddings.json) |
| Embedding      | Gemini Embedding (gemini-embedding-001) | Gemini Embedding (同じ)  |
| 認証           | Firebase Authentication        | Firebase Authentication (同じ)   |
| 学習履歴DB     | Firestore                      | Firestore (同じ)                 |
| データ保管     | ローカルファイル               | S3                               |

### 4.2 性能要件

| 項目               | 目標値           |
| ------------------ | ---------------- |
| 質問応答レスポンス | 10秒以内         |
| クイズ生成         | 10秒以内         |
| Lambda タイムアウト| 60秒             |
| Lambda メモリ      | 512MB            |

### 4.3 対応環境

- ブラウザ: Chrome（最新版）
- OS: Windows 10/11
- Google Cloud（Gemini API キー）
- Firebase プロジェクト（Auth + Firestore）
- AWS アカウント（Free Tier）

---

## 5. データ

### 5.1 教育マニュアル（入力）

- PDF形式の教育マニュアルを前提とする
- PDF → OCR → テキスト抽出 → チャンク分割 → JSON保存
- GCP Vision API でOCR処理

### 5.2 チャンクJSON形式

```json
{
  "chunk_id": "manual_001",
  "section": "セクション名",
  "metadata": {
    "source": "教育マニュアル.pdf",
    "category": "カテゴリ",
    "area": "分野",
    "tags": ["キーワード1", "キーワード2"]
  },
  "content": "チャンクのテキスト内容..."
}
```

### 5.3 ベクトルデータ（embeddings.json）

ローカルでChromaDBに登録したデータをJSON形式でエクスポートし、
Lambda環境ではChromaDB不要の軽量ベクトル検索（コサイン類似度）で利用する。

---

## 6. 画面一覧

| # | 画面名               | 概要                                           |
| - | -------------------- | ---------------------------------------------- |
| 1 | ログイン画面         | メール/パスワード or Google でログイン          |
| 2 | サイドバーナビゲーション | QA / 問題演習 / クイズ / 学習記録 を切り替え |
| 3 | QA画面               | チャット形式で質問応答                         |
| 4 | 問題演習画面         | 4択ドリル形式                                  |
| 5 | クイズ画面           | 難易度選択 → 5問出題 → 結果 → 正答率表示       |
| 6 | 学習記録ダッシュボード | 統計カード + 直近の履歴一覧                   |

---

## 7. 今回やらないこと（スコープ外）

| # | 項目                             | 理由                               |
| - | -------------------------------- | ---------------------------------- |
| 1 | マニュアルの動的アップロード    | v2 で対応                          |
| 2 | 管理者画面                      | MVP では不要                       |
| 3 | モバイル対応                    | PC Chrome のみ                     |
| 4 | 多言語対応                      | 日本語のみ                         |
| 5 | カスタムドメイン/HTTPS          | Free Tier では S3 HTTP で運用      |

---

## 8. 開発スケジュール目安

| フェーズ       | 期間     | 内容                           |
| -------------- | -------- | ------------------------------ |
| 設計           | 1-2日目  | 要件定義・基本設計・API設計    |
| 環境構築       | 2-3日目  | Vite+React / FastAPI / Gemini  |
| RAG実装        | 3-5日目  | データ取込・検索・回答生成     |
| クイズ＋演習   | 5-7日目  | 5問セット・判定・4択ドリル     |
| 認証＋履歴     | 7-8日目  | Firebase Auth + Firestore      |
| デプロイ       | 8-9日目  | AWS Lambda + S3                |
| テスト＋整備   | 9-10日目 | 動作確認・README・ドキュメント |

---

## 変更履歴

| 日付       | バージョン | 内容         |
| ---------- | ---------- | ------------ |
| 2026/02/16 | 1.0        | 初版作成     |
| 2026/02/16 | 1.1        | AWS構成に変更（Bedrock/Lambda/Amplify） |
| 2026/02/16 | 2.0        | 実装に合わせ全面改訂（Gemini API/Firebase/5問クイズ/4択演習/S3デプロイ） |
