# 要件定義書

## RAG教育クイズアプリ

| 項目       | 内容                         |
| ---------- | ---------------------------- |
| 作成日     | 2026/02/16                   |
| バージョン | 1.0                          |
| ステータス | ドラフト                     |

---

## 1. 目的・ゴール

### 目的

新人教育で使用するマニュアル（PDF等）の内容をRAGとして取り込み、
**自然言語で質問応答**および**理解度テスト（クイズ）**を行える学習支援アプリを開発する。

### ゴール

- 新人が教育マニュアルの内容を**対話形式で学習**できる
- 理解度を**クイズ形式で自己チェック**できる
- 回答にはマニュアルの**根拠（出典）**が表示される

---

## 2. 対象ユーザー

| ユーザー | 説明                                       |
| -------- | ------------------------------------------ |
| 新人社員 | 教育マニュアルの内容を学習する             |
| 教育担当 | マニュアルPDFをアップロード・管理する（v2）|

※ v1（MVP）では新人社員のみを対象とする

---

## 3. 機能一覧

### 3.1 RAG質問応答機能（必須）

| # | 機能             | 説明                                                   |
| - | ---------------- | ------------------------------------------------------ |
| 1 | 自然言語質問     | テキスト入力欄から自由文で質問できる                   |
| 2 | RAG検索・回答    | マニュアルから関連箇所を検索し、LLMが回答を生成する   |
| 3 | 出典表示         | 回答の根拠となったマニュアルの該当箇所を表示する       |
| 4 | 会話履歴         | 同一セッション内で過去のやり取りを保持する             |

### 3.2 理解度テスト（クイズ）機能（必須）

| # | 機能             | 説明                                                   |
| - | ---------------- | ------------------------------------------------------ |
| 1 | 難易度選択       | 初級 / 中級 / 上級 の3段階から選択できる               |
| 2 | クイズ生成       | マニュアル内容を元にLLMがランダムにクイズを生成する   |
| 3 | 自然言語回答     | クイズに対して自由文で回答できる                       |
| 4 | ○×判定・採点     | LLMが回答の正誤を判定し、正解率を表示する             |
| 5 | 解説表示         | 不正解時にマニュアルに基づく解説を返す                 |
| 6 | 連続出題         | 対話形式で繰り返しクイズを受けられる                   |

### 3.3 難易度の定義

| 難易度 | 出題傾向                                           | 回答判定基準                     |
| ------ | -------------------------------------------------- | -------------------------------- |
| 初級   | マニュアルに直接書かれている事実の確認              | キーワードが含まれていれば正解   |
| 中級   | 複数箇所の情報を組み合わせて答える問題              | 要点を押さえていれば正解         |
| 上級   | 応用・考察を求める問題（「なぜ？」「どう思う？」） | 論理的に妥当であれば正解         |

---

## 4. 非機能要件

### 4.1 技術スタック

| レイヤー       | ローカル開発                   | AWS本番                        |
| -------------- | ------------------------------ | ------------------------------ |
| フロントエンド | Next.js (React)                | AWS Amplify                    |
| バックエンド   | Python (FastAPI)               | Lambda + API Gateway           |
| LLM            | Amazon Bedrock (Claude 3.5 Haiku) | Amazon Bedrock              |
| ベクトルDB     | ChromaDB                       | OpenSearch Serverless          |
| Embedding      | HuggingFace (multilingual-e5)  | Bedrock Titan Embeddings       |
| PDF保存        | GCS (ex_pdf)                   | S3                             |
| OCR            | GCP Vision API                 | Amazon Textract                |
| データ形式     | JSON チャンク                  | JSON チャンク（共通）          |

### 4.2 性能要件

| 項目               | 目標値           |
| ------------------ | ---------------- |
| 質問応答レスポンス | 10秒以内         |
| クイズ生成         | 10秒以内         |
| 同時接続           | 1（ローカル）/ 複数（AWS） |

### 4.3 対応環境

- ブラウザ: Chrome（最新版）
- OS: Windows 10/11
- AWSアカウント（Bedrock モデルアクセス有効化済み）
- AWS CLI 設定済み（ローカル開発時）

---

## 5. データ

### 5.1 教育マニュアル（入力）

- PDF形式の教育マニュアルを前提とする
- PDF → OCR → テキスト抽出 → チャンク分割 → JSON保存
- 既存のOCRパイプライン（`run_vision_ocr.py` / ローカルTesseract）を活用可能

### 5.2 チャンクJSON形式（既存RAGシステム互換）

```json
{
  "chunk_id": "manual_001",
  "section": "セクション名",
  "metadata": {
    "source": "教育マニュアル.pdf",
    "category": "カテゴリ",
    "area": "分野",
    "tags": ["キーワード1", "キーワード2"]
  },
  "content": "チャンクのテキスト内容..."
}
```

---

## 6. 画面一覧（MVP）

| # | 画面名     | 概要                                   |
| - | ---------- | -------------------------------------- |
| 1 | トップ画面 | QA / クイズ の選択                     |
| 2 | QA画面     | チャット形式で質問応答                 |
| 3 | クイズ画面 | 難易度選択 → 出題 → 回答 → 判定       |

---

## 7. 今回やらないこと（スコープ外）

| # | 項目                             | 理由                               |
| - | -------------------------------- | ---------------------------------- |
| 1 | ユーザー認証・ログイン          | MVP では不要                       |
| 2 | マニュアルの動的アップロード    | v2 で対応                          |
| 3 | 学習履歴の永続化・分析          | v2 で対応                          |
| 4 | 複数LLMプロバイダー切替         | Bedrock単一で十分                  |
| 5 | モバイル対応                    | PC Chrome のみ                     |
| 6 | マルチユーザー同時利用          | ローカル1人利用を前提              |
| 7 | クイズの選択式（4択）           | 自然言語回答のみ                   |

---

## 8. 開発スケジュール目安

| フェーズ | 期間     | 内容                           |
| -------- | -------- | ------------------------------ |
| 設計     | 1-2日目  | 要件定義・基本設計・API設計    |
| 環境構築 | 2-3日目  | Next.js / FastAPI / Ollama 構築|
| RAG実装  | 3-5日目  | データ取込・検索・回答生成     |
| クイズ   | 5-7日目  | 生成・判定・解説               |
| 結合     | 7-8日目  | フロント＋バックエンド結合     |
| テスト   | 9日目    | 動作確認・バグ修正             |
| 整備     | 10日目   | README・ドキュメント整備       |

---

## 変更履歴

| 日付       | バージョン | 内容         |
| ---------- | ---------- | ------------ |
| 2026/02/16 | 1.0        | 初版作成     |
| 2026/02/16 | 1.1        | AWS構成に変更（Bedrock/Lambda/Amplify） |
